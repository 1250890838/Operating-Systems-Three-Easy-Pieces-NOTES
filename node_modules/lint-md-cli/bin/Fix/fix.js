"use strict";

var path = require('path');

var fs = require('fs');

var _require = require('lint-md'),
    fix = _require.fix,
    version = _require.version;
/**
 * 使用 ast 和规则进行 fix
 * @param f
 * @param config
 * @returns {Promise<any>}
 */


module.exports = function (f, config) {
  var rules = config.rules;
  return new Promise(function (resolve, reject) {
    var file = path.resolve(f);
    var markdown = fs.readFileSync(file, {
      encoding: 'utf8'
    }); // 修复之后的 markdown

    var newMarkdown = fix(markdown, rules); // 如果不相同，那么保存回去

    if (newMarkdown !== markdown) {
      fs.writeFileSync(file, newMarkdown, {
        encoding: 'utf8'
      });
      resolve(true);
    } else {
      resolve(false);
    }
  });
};